var dynamicSelection=function(){"use strict";function e(e){var t=[],o=n.getItemValue(e.itemName);return""!=o&&(t=o.split(e.splitStr)),t}function t(t,o,s){$.each(o,function(o,i){var r=$(i),c=r.text().match(s.replexRegex)[1];(o=$("<i></i>")).addClass("fa");e(s).indexOf(c)>-1?o.addClass(s.selectedIcon):o.addClass(s.unselectedIcon),o.addClass("dynamic-selection-element-icon"),r.attr("key-str",c),r.addClass("dynamic-selection-element"),r.css("cursor","pointer"),r.html(o),r.on("click",function(){var t=o.hasClass(s.unselectedIcon);!function(t,o,s){var i=e(t);s?i.push(o):n.removeElementFromArray(i,o);var r=i.join(t.splitStr);n.setItemValue(t.itemName,r)}(s,c,t),o.toggleClass(s.unselectedIcon),o.toggleClass(s.selectedIcon)}),r.contextmenu(function(e){var o=[];o.push({icon:s.selectedIcon,text:s.selectAllText,action:function(){var e=$(t).find(".dynamic-selection-element-icon");e.removeClass(s.unselectedIcon),e.addClass(s.selectedIcon);var o=[];$.each($(t).find(".dynamic-selection-element"),function(e,t){o.push($(t).attr("key-str"))});var i=o.join(s.splitStr);n.setItemValue(s.itemName,i)}}),o.push({icon:s.unselectedIcon,text:s.unselectAllText,action:function(){var e=$(t).find(".dynamic-selection-element-icon");e.removeClass(s.selectedIcon),e.addClass(s.unselectedIcon),n.setItemValue(s.itemName,"")}}),function(e,t){t.preventDefault();var o=$("<div></div>");$.each(e,function(t,s){var i=$("<div></div>");t+1<e.length&&i.css("margin-bottom","4px"),i.css("cursor","pointer"),s.action&&i.on("click",function(){s.action()});var r=$("<span></span>");n.isDefinedAndNotNull(s.icon)&&(r.addClass("fa"),r.addClass(s.icon)),r.css("width","20px"),r.css("line-height","17px"),i.append(r);var c=$("<span></span>");c.css("line-height","16px"),c.css("vertical-align","top"),n.isDefinedAndNotNull(s.text)&&c.text(s.text),i.append(c),o.append(i)}),n.tooltip.show(o),n.tooltip.setPosition(t)}(o,e)}),$(document).on("touchstart click",function(e){r.is(e.target)||0!==r.has(e.target).length||n.tooltip.hide()})})}function o(e,o){try{var s=new RegExp(o.replexRegex);if("report"===o.type){t(e,$(e).find("td").filter(function(){return s.test($(this).text())}),o)}else{t(e,$(e).find(".dynamic-selection-element").filter(function(){return s.test($(this).text())}),o)}}catch(e){n.debug.error({module:"findePossibleItems",msg:"error while try to render selection items",err:e})}}var n={featureInfo:{name:"APEX Dynamic Selection",info:{scriptVersion:"1.0",utilVersion:"1.3.5",url:"https://github.com/RonnyWeiss",license:"MIT"}},isDefinedAndNotNull:function(e){return void 0!==e&&null!==e&&""!=e},isAPEX:function(){return"undefined"!=typeof apex},varType:function(e){if("object"!=typeof e)return typeof e;var t=[].constructor,o={}.constructor;return e.constructor===t?"array":e.constructor===o?"json":void 0},debug:{info:function(){if(n.isAPEX()){var e=0,t=[];for(var o in arguments)t[e]=arguments[o],e++;t.push(n.featureInfo),apex.debug.info.apply(this,t)}},error:function(){var e=0,t=[];for(var o in arguments)t[e]=arguments[o],e++;t.push(n.featureInfo),n.isAPEX()?apex.debug.error.apply(this,t):console.error.apply(this,t)}},setItemValue:function(e,t){n.isAPEX()?apex.item(e)&&0!=apex.item(e).node?apex.item(e).setValue(t):n.debug.error("Please choose a set item. Because the value ("+t+") can not be set on item ("+e+")"):n.debug.error("Error while try to call apex.item")},getItemValue:function(e){if(!e)return"";if(n.isAPEX()){if(apex.item(e)&&0!=apex.item(e).node)return apex.item(e).getValue();n.debug.error("Please choose a get item. Because the value could not be get from item("+e+")")}else n.debug.error("Error while try to call apex.item")},removeElementFromArray:function(e,t){if(n.varType(e)){if(t){for(var o=0;o<e.length;)e[o]==t?e.splice(o,1):++o;return e}n.debug.error("Error while try to remove element from array. No element to remove is given.")}else n.debug.error("Error while try to remove element from array. Given array is not an array.")},tooltip:{show:function(e,t,o){try{if(0==$("#dynToolTip").length){var n=$("<div></div>").attr("id","dynToolTip").css("max-width","400px").css("position","absolute").css("top","0px").css("left","0px").css("z-index","2000").css("background-color","rgba(240, 240, 240, 1)").css("padding","10px").css("display","block").css("top","0").css("overflow-wrap","break-word").css("word-wrap","break-word").css("-ms-hyphens","auto").css("-moz-hyphens","auto").css("-webkit-hyphens","auto").css("hyphens","auto");t&&n.css("background-color",t),o&&n.css("max-width",o),$("body").append(n)}else $("#dynToolTip").css("visibility","visible");$("#dynToolTip").html(e),$("#dynToolTip").find("*").css("max-width","100%").css("overflow-wrap","break-word").css("word-wrap","break-word").css("-ms-hyphens","auto").css("-moz-hyphens","auto").css("-webkit-hyphens","auto").css("hyphens","auto").css("white-space","normal"),$("#dynToolTip").find("img").css("object-fit","contain").css("object-position","50% 0%")}catch(e){console.error("Error while try to show tooltip"),console.error(e)}},setPosition:function(e){$("#dynToolTip").position({my:"left+6 top+6",of:e,collision:"flipfit"})},hide:function(){$("#dynToolTip").css("visibility","hidden")},remove:function(){$("#dynToolTip").remove()}}};return{initialize:function(e,t,s,i,r,c,a,l,d){n.debug.info({pThis:e,pUseType:t,pUsedRegex:s,pItemName:i,pSplitStr:r,pUnselectIcon:c,pSelectIcon:a,pUnselectAllText:l,pSelectAllText:d});var u={};u.this=e,u.type=t,u.itemName=i,u.splitStr=r,u.replexRegex=s,u.unselectedIcon=c,u.selectedIcon=a,u.unselectAllText=l,u.selectAllText=d,$.each(e.affectedElements,function(e,t){o(t,u),$(t).on("apexafterrefresh",function(){o(t,u)}),$(t).on("gridpagechange",function(){o(t,u)})})}}}();